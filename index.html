<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á ‡∏™.‡∏™. ‡πÄ‡∏Ç‡∏ï 4 ‡∏Å‡∏ó‡∏°. ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£ (5/18 ‡∏™‡∏™.)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.3.6/css/buttons.bootstrap5.min.css">
    
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f8f9fa; }
        .card-stat { border: none; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); color: white; margin-bottom: 20px;}
        .bg-turnout { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .bg-good { background: linear-gradient(135deg, #2af598 0%, #009efd 100%); }
        .bg-bad { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%); color: #444; }
        .bg-no { background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); color: #444; }
        
        /* Table Styles */
        #stationTable th { text-align: center; vertical-align: middle; white-space: nowrap; font-size: 0.9rem; }
        #stationTable td { text-align: right; vertical-align: middle; font-size: 0.9rem; }
        #stationTable td:first-child { text-align: left; font-weight: bold; min-width: 120px; }
        
        .winner-cell { background-color: #d1e7dd !important; color: #0f5132; font-weight: bold; border: 2px solid #198754 !important; }
        .candidate-bar-container { height: 8px; background-color: #e9ecef; border-radius: 4px; width: 100%; margin-top: 5px; }
        .candidate-bar { height: 100%; border-radius: 4px; }
    </style>
</head>
<body>

<div class="container-fluid py-4 px-4">
    <div class="text-center mb-4">
        <h2 class="text-primary fw-bold">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á ‡∏™.‡∏™. ‡πÄ‡∏Ç‡∏ï 4 ‡∏Å‡∏ó‡∏°. (‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢)</h2>
        <h5 class="text-secondary">‡πÅ‡∏Ç‡∏ß‡∏á‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢, ‡πÅ‡∏Ç‡∏ß‡∏á‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô, ‡πÅ‡∏Ç‡∏ß‡∏á‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á</h5>
        <p class="small text-muted">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á: ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ 5/18 ‡∏™‡∏™.</p>
    </div>

    <div class="row g-3">
        <div class="col-lg-3 col-6">
            <div class="card card-stat bg-turnout p-3">
                <h6>‡∏ú‡∏π‡πâ‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥</h6>
                <h3 id="sum-turnout">0</h3>
                <small id="sum-turnout-pct">‡∏à‡∏≤‡∏Å ...</small>
            </div>
        </div>
        <div class="col-lg-3 col-6">
            <div class="card card-stat bg-good p-3">
                <h6>‡∏ö‡∏±‡∏ï‡∏£‡∏î‡∏µ</h6>
                <h3 id="sum-good">0</h3>
                <small id="sum-good-pct">...</small>
            </div>
        </div>
        <div class="col-lg-3 col-6">
            <div class="card card-stat bg-bad p-3">
                <h6>‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏™‡∏µ‡∏¢</h6>
                <h3 id="sum-bad">0</h3>
                <small id="sum-bad-pct">...</small>
            </div>
        </div>
        <div class="col-lg-3 col-6">
            <div class="card card-stat bg-no p-3">
                <h6>‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏î (Vote NO)</h6>
                <h3 id="sum-no">0</h3>
                <small id="sum-no-pct">...</small>
            </div>
        </div>
    </div>

    <div class="row mt-3">
        <div class="col-lg-4 mb-3">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-header bg-white">
                    <h5 class="m-0 text-primary">üèÜ ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</h5>
                </div>
                <div class="card-body p-0" style="overflow-y: auto; max-height: 600px;">
                    <table class="table table-hover mb-0">
                        <thead class="table-light sticky-top">
                            <tr>
                                <th>#</th>
                                <th>‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</th>
                                <th class="text-end">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                            </tr>
                        </thead>
                        <tbody id="candidate-ranks">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="col-lg-8">
            <div class="card shadow-sm border-0">
                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                    <h5 class="m-0 text-primary">üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á (103 ‡∏´‡∏ô‡πà‡∏ß‡∏¢)</h5>
                    <div class="small text-muted">*‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏ä‡∏ô‡∏∞‡πÉ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡πâ‡∏ô</div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="stationTable" class="table table-bordered table-striped text-nowrap w-100">
                            <thead class="table-dark">
                                <tr>
                                    <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á</th>
                                    <th>‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥</th>
                                    <th>‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥</th>
                                    <th>‡∏ö‡∏±‡∏ï‡∏£‡∏î‡∏µ</th>
                                    <th>‡πÄ‡∏™‡∏µ‡∏¢</th>
                                    <th>No</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 1">#1</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 2">#2</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 3">#3</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 4">#4</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 5">#5</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 6">#6</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 7">#7</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 8">#8</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 9">#9</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 10">#10</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 11">#11</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 12">#12</th>
                                    <th title="‡πÄ‡∏ö‡∏≠‡∏£‡πå 13">#13</th>
                                </tr>
                            </thead>
                            <tbody id="station-rows">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.bootstrap5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js"></script>

<script>
    // 1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£ (Candidate Meta Data)
    const candidates = [
        {no: 1, name: "‡∏ô‡∏≤‡∏¢‡∏û‡∏á‡∏®‡∏Å‡∏£ ‡∏Ç‡∏ß‡∏±‡∏ç‡πÄ‡∏°‡∏∑‡∏≠‡∏á", party: "‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ò‡∏¥‡∏õ‡∏±‡∏ï‡∏¢‡πå", color: "#0d6efd"},
        {no: 2, name: "‡∏ô‡∏≤‡∏¢‡∏†‡∏±‡∏ì‡∏ë‡∏¥‡∏• ‡∏ô‡πà‡∏ß‡∏°‡πÄ‡∏à‡∏¥‡∏°", party: "‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô", color: "#dc6f35"},
        {no: 3, name: "‡∏ô‡∏≤‡∏¢‡∏ä‡∏¢‡∏û‡∏á‡∏®‡πå ‡∏™‡∏≤‡∏¢‡∏ü‡πâ‡∏≤", party: "‡πÑ‡∏ó‡∏¢‡∏Å‡πâ‡∏≤‡∏ß‡πÉ‡∏´‡∏°‡πà", color: "#6c757d"},
        {no: 4, name: "‡∏ô.‡∏™.‡∏ö‡∏∏‡∏ì‡∏¢‡∏Å‡∏£ ‡∏î‡∏≥‡∏£‡∏á‡∏£‡∏±‡∏ï‡∏ô‡πå", party: "‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢", color: "#dc3545"},
        {no: 5, name: "‡∏ô‡∏≤‡∏¢‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡πÑ‡∏Å‡∏£ ‡∏•‡∏µ‡∏Å‡∏¥‡∏à‡∏ß‡∏±‡∏í‡∏ô‡∏∞", party: "‡∏û‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏£‡∏±‡∏ê", color: "#0d6efd"},
        {no: 6, name: "‡∏ô‡∏≤‡∏¢‡πÄ‡∏Ç‡∏ï‡∏£‡∏±‡∏ê ‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ò‡∏£‡∏£‡∏°‡∏ó‡∏±‡∏®‡∏ô‡πå", party: "‡∏†‡∏π‡∏°‡∏¥‡πÉ‡∏à‡πÑ‡∏ó‡∏¢", color: "#00008b"},
        {no: 7, name: "‡∏ô‡∏≤‡∏¢‡∏≠‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏±‡∏ó‡∏ò‡πå ‡πÇ‡∏®‡∏†‡∏ß‡∏±‡∏í‡∏ô‡∏≤‡∏™‡∏¥‡∏£‡∏¥", party: "‡∏õ‡∏ß‡∏á‡∏ä‡∏ô‡πÑ‡∏ó‡∏¢", color: "#6c757d"},
        {no: 8, name: "‡∏ô‡∏≤‡∏¢‡∏£‡∏∏‡∏à‡∏¥‡∏£‡∏∞ ‡∏≠‡∏±‡∏Ñ‡∏£‡∏≤‡∏û‡∏¥‡∏£‡∏¥‡∏¢‡∏û‡∏á‡∏®‡πå", party: "‡πÑ‡∏ó‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ó‡∏¢", color: "#0d6efd"},
        {no: 9, name: "‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏¢‡∏ï‡∏£‡∏µ‡∏´‡∏ç‡∏¥‡∏á ‡∏õ‡∏†‡∏±‡∏™‡∏£‡∏≤‡∏ß‡∏£‡∏£‡∏ì", party: "‡∏Å‡∏•‡πâ‡∏≤‡∏ò‡∏£‡∏£‡∏°", color: "#6c757d"},
        {no: 10, name: "‡∏ô‡∏≤‡∏¢‡∏ö‡∏∏‡∏ç‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥ ‡∏ß‡∏¥‡∏®‡∏≤‡∏•‡πÇ‡∏Å‡∏®‡∏•", party: "‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à", color: "#6c757d"},
        {no: 11, name: "‡∏ô‡∏≤‡∏¢‡∏™‡∏£‡∏¢‡∏∏‡∏ó‡∏ò ‡∏•‡∏¥‡∏Ç‡∏¥‡∏ï‡∏≠‡∏≤‡∏†‡∏≤‡∏Å‡∏∏‡∏•", party: "‡∏£‡∏±‡∏Å‡∏ä‡∏≤‡∏ï‡∏¥", color: "#6c757d"},
        {no: 12, name: "‡∏ô‡∏≤‡∏¢‡∏™‡∏Å‡∏•‡∏†‡∏±‡∏ó‡∏£ ‡∏õ‡∏£‡∏∞‡∏¢‡∏π‡∏£‡∏£‡∏±‡∏ï‡∏ô‡πå", party: "‡∏£‡∏ß‡∏°‡πÑ‡∏ó‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏≤‡∏ï‡∏¥", color: "#0d6efd"},
        {no: 13, name: "‡∏ô.‡∏™.‡∏û‡∏£‡∏û‡∏¥‡∏°‡∏• ‡∏â‡∏¥‡∏°‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå", party: "‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÉ‡∏´‡∏°‡πà", color: "#6c757d"}
    ];

    // 2. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå 5 18 ‡∏™‡∏™..html)
    // Structure: [StationName, Eligible, Turnout, Good, Bad, No, Score1...Score13]
    const fullStationData = [
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢1",668,417,388,7,22,147,153,2,19,1,45,0,3,4,9,3,2,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢2",695,428,395,8,25,162,139,2,31,2,34,3,2,5,9,4,2,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢3",705,393,359,8,26,131,116,2,30,3,52,2,1,6,12,2,1,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢4",680,405,385,8,12,124,171,3,14,4,49,1,1,6,6,2,3,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢5",684,393,366,13,14,97,167,0,35,2,34,2,2,10,4,5,5,3],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢6",684,428,401,5,22,122,156,3,25,1,75,4,0,3,3,4,5,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢7",578,360,340,3,17,78,160,1,22,2,58,1,4,4,4,1,5,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢8",413,267,259,1,7,102,97,0,10,0,40,0,0,2,5,2,1,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢9",477,341,316,3,22,110,129,0,16,2,38,1,2,3,4,2,4,5],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢10",823,522,495,7,20,156,212,2,27,2,70,0,5,4,8,3,5,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢11",813,556,526,6,24,130,261,4,33,2,75,0,4,2,7,4,4,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢12",822,520,499,11,10,184,203,1,25,3,58,0,5,4,5,2,7,2],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢13",721,419,393,7,19,99,174,4,21,3,73,1,1,1,6,2,8,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢14",739,465,439,10,16,102,213,1,19,1,77,3,1,10,3,2,7,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢15",626,398,376,2,20,102,163,2,26,3,63,0,2,3,7,0,5,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢16",728,459,432,11,16,105,216,3,16,1,65,4,5,7,3,2,4,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢17",706,454,426,8,20,100,213,2,30,0,67,1,2,2,3,1,5,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢18",714,473,450,8,15,144,189,2,22,3,73,0,1,3,4,0,8,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢19",700,413,397,5,11,154,152,0,28,0,36,1,2,5,13,1,4,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢20",729,407,383,8,16,145,147,1,38,4,29,1,1,8,3,3,3,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢21",743,375,343,17,15,164,95,5,32,2,17,2,2,13,1,6,3,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢22",483,276,262,4,10,170,66,0,8,2,7,0,0,3,5,0,1,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢23",740,471,438,9,24,139,192,4,30,1,47,3,2,6,6,3,4,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢24",788,483,453,9,21,138,193,2,20,3,73,4,1,2,6,1,9,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢25",732,488,456,11,21,123,201,0,23,3,77,2,5,2,9,2,9,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢26",483,328,307,5,16,92,107,1,18,1,75,1,2,4,0,3,2,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢27",482,315,296,7,12,92,122,1,18,2,39,0,5,6,2,2,6,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢28",585,459,418,8,33,156,170,1,15,2,50,0,3,3,10,1,7,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢29",302,194,183,1,10,67,75,0,27,2,8,0,0,2,0,1,0,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢30",927,514,472,21,21,223,139,2,46,0,29,1,0,11,9,2,8,2],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢31",901,490,467,8,15,230,148,2,37,4,21,1,5,8,4,3,4,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢32",905,507,469,14,24,224,163,4,32,3,20,1,2,12,2,3,2,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢33",909,515,475,17,23,237,138,2,41,0,18,1,1,10,14,7,4,2],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢34",851,573,519,10,44,198,220,4,30,3,33,1,2,7,11,3,7,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢35",617,405,366,10,29,169,101,4,37,0,35,2,3,3,6,3,3,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢36",683,384,355,13,16,173,121,3,20,3,19,1,2,6,0,2,4,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢37",684,390,368,12,10,176,137,0,20,1,13,2,2,8,4,2,3,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢38",413,295,274,2,19,121,97,5,14,1,17,3,2,5,2,5,2,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢39",459,304,284,9,11,130,97,2,16,2,23,2,2,2,3,1,4,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢40",681,439,412,8,19,170,168,3,28,1,18,2,5,4,7,1,4,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢41",700,433,407,11,15,185,142,5,24,1,27,2,2,2,13,2,1,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢42",718,474,434,17,23,190,151,1,35,1,33,0,3,8,3,3,6,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢43",546,359,338,11,10,140,125,0,33,1,25,0,4,1,1,2,6,3],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢44",761,375,350,15,10,183,114,0,20,0,16,1,2,6,3,2,3,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢45",812,383,365,11,7,191,126,2,20,0,11,0,4,1,5,2,2,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢46",806,366,346,8,12,200,103,1,14,2,8,1,1,3,2,6,5,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢47",761,414,388,13,13,214,119,1,24,2,9,0,2,1,9,0,7,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢48",785,371,349,14,8,174,114,4,19,1,17,2,3,7,1,1,6,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢49",794,417,381,17,19,220,95,0,35,2,15,1,0,3,3,4,0,3],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢50",752,403,377,10,16,192,128,2,29,0,14,0,3,3,5,1,0,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢51",456,243,227,8,8,104,76,1,19,0,18,1,0,2,4,1,0,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢52",803,500,477,5,18,217,156,2,36,3,36,1,1,10,4,5,6,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢53",794,485,460,10,15,184,206,3,27,3,15,2,1,8,7,2,2,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢54",823,473,445,14,14,161,176,1,36,1,36,3,3,11,10,2,5,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢55",589,424,396,7,21,169,147,3,20,1,39,0,3,0,8,3,3,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢56",595,412,395,1,16,213,107,2,21,3,32,0,4,4,3,1,4,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢57",613,405,387,7,11,189,137,0,24,0,23,1,2,2,7,1,1,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢58",564,331,313,14,4,170,106,0,14,0,10,0,0,6,2,0,4,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢59",788,437,408,11,18,221,135,3,12,1,23,2,1,5,1,3,1,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢60",851,526,504,13,9,252,180,0,38,2,15,2,0,7,6,1,1,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢61",809,470,436,13,21,232,134,2,29,6,26,2,1,2,1,2,3,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢62",809,480,455,6,19,231,147,2,24,1,27,4,1,9,4,1,2,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢63",502,318,295,11,12,132,99,3,17,4,30,0,1,4,6,0,3,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢64",528,296,281,10,5,100,100,2,23,6,39,2,3,6,2,2,1,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢65",596,336,304,10,22,96,122,1,35,2,31,2,1,7,0,1,4,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢66",610,329,303,15,11,112,109,3,14,3,30,0,5,8,11,4,4,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ï‡∏¢67",635,378,342,14,22,156,115,2,12,6,39,1,3,9,3,0,1,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô1",726,421,399,7,15,136,146,1,18,3,70,0,3,2,6,3,8,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô2",841,521,504,5,12,114,252,2,23,6,97,2,3,1,3,0,7,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô3",866,566,531,10,25,138,256,2,29,2,83,1,1,1,6,3,8,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô4",849,556,533,5,18,119,264,1,20,3,107,0,1,3,3,3,8,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô5",855,606,578,6,22,133,325,3,27,3,69,4,1,6,2,0,7,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô6",859,598,563,11,24,162,252,2,23,2,95,1,2,6,2,4,7,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô7",702,444,424,10,10,124,206,5,25,6,54,2,0,3,6,1,2,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô8",695,461,439,12,10,122,201,1,16,2,79,0,0,2,2,3,4,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô9",814,534,503,5,26,123,226,4,29,1,106,3,2,1,3,1,6,0],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô10",771,489,464,7,18,168,193,4,11,1,65,0,3,8,3,2,4,1],
        ["‡∏Ñ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡∏ô11",746,448,423,7,18,131,186,3,35,1,43,4,1,1,4,4,7,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á1",876,609,583,4,22,157,294,5,10,1,101,1,2,3,5,0,7,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á2",873,612,584,6,22,141,281,3,29,1,103,0,2,1,2,0,11,3],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á3",844,528,508,4,16,133,229,1,30,3,88,2,2,2,8,2,6,1],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á4",871,591,568,3,20,114,296,2,31,1,98,2,4,5,4,3,10,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á5",890,610,587,3,20,127,347,0,20,1,68,0,3,7,4,2,8,1],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á6",525,365,345,1,19,56,227,1,15,0,41,0,6,7,6,0,0,1],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á7",572,396,359,5,32,87,165,2,18,3,68,1,2,7,0,1,8,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á8",727,444,412,8,24,112,213,1,16,1,47,1,3,5,4,1,6,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á9",716,440,416,6,18,116,184,1,25,1,68,3,1,5,1,1,5,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á10",679,373,344,11,18,104,144,5,24,2,48,2,3,2,2,2,4,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á11",708,437,400,13,24,105,191,4,23,0,62,2,4,5,10,4,4,1],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á12",680,451,420,7,24,114,186,1,22,0,71,2,1,3,1,2,4,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á13",651,350,330,10,10,62,198,2,17,3,29,0,1,7,2,4,3,2],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á14",705,449,415,10,24,110,223,5,22,0,42,2,1,7,5,3,4,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á15",510,299,275,9,15,94,112,4,21,1,30,2,1,3,2,0,1,1],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á16",465,271,253,9,9,103,74,1,34,2,23,0,1,2,5,3,2,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á17",795,439,401,22,16,120,187,2,29,2,35,0,1,3,3,2,4,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á18",790,419,380,13,26,134,171,1,16,2,37,0,1,1,9,2,1,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á19",582,367,336,31,0,71,157,1,23,1,66,1,1,1,5,3,3,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á20",480,255,232,11,12,85,85,5,18,2,30,1,1,6,5,2,1,1],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á21",810,507,484,2,21,102,240,4,16,1,96,2,2,5,5,2,7,1],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á22",821,575,552,5,18,98,315,1,26,1,86,0,2,1,8,3,13,2],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á23",816,526,495,12,19,125,250,5,32,2,58,4,4,6,0,2,16,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á24",825,525,497,4,24,76,286,7,42,1,56,2,3,5,1,2,9,0],
        ["‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á25",817,587,567,6,14,121,337,7,31,2,50,0,6,0,1,1,8,0]
    ];

    $(document).ready(function () {
        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (Summary) ---
        let totalEligible = 0, totalTurnout = 0, totalGood = 0, totalBad = 0, totalNo = 0;
        let candidateScores = Array(13).fill(0);

        fullStationData.forEach(st => {
            totalEligible += st[1];
            totalTurnout += st[2];
            totalGood += st[3];
            totalBad += st[4];
            totalNo += st[5];
            
            // ‡∏£‡∏ß‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£
            for(let i=0; i<13; i++) {
                candidateScores[i] += st[6+i];
            }
        });

        // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• Summary
        $('#sum-turnout').text(totalTurnout.toLocaleString());
        $('#sum-turnout-pct').text(`‡∏à‡∏≤‡∏Å ${totalEligible.toLocaleString()} (${((totalTurnout/totalEligible)*100).toFixed(2)}%)`);
        
        $('#sum-good').text(totalGood.toLocaleString());
        $('#sum-good-pct').text(`${((totalGood/totalTurnout)*100).toFixed(2)}% ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥`);

        $('#sum-bad').text(totalBad.toLocaleString());
        $('#sum-bad-pct').text(`${((totalBad/totalTurnout)*100).toFixed(2)}% ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥`);

        $('#sum-no').text(totalNo.toLocaleString());
        $('#sum-no-pct').text(`${((totalNo/totalTurnout)*100).toFixed(2)}% ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥`);

        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏à‡∏±‡∏î‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£ (Overall Ranking) ---
        const rankedCandidates = candidates.map((c, i) => ({
            ...c,
            score: candidateScores[i]
        })).sort((a, b) => b.score - a.score);

        const maxScore = rankedCandidates[0].score;

        rankedCandidates.forEach((c, index) => {
            const isWinner = index === 0;
            const barWidth = (c.score / maxScore) * 100;
            
            const row = `
                <tr>
                    <td class="text-center fw-bold">${index + 1}</td>
                    <td>
                        <div class="fw-bold ${isWinner ? 'text-warning' : ''}">
                            <span class="badge bg-secondary rounded-pill me-1">${c.no}</span> ${c.name} ${isWinner ? 'üèÜ' : ''}
                        </div>
                        <small class="text-muted">${c.party}</small>
                        <div class="candidate-bar-container">
                            <div class="candidate-bar" style="width: ${barWidth}%; background-color: ${c.color}"></div>
                        </div>
                    </td>
                    <td class="text-end fw-bold">${c.score.toLocaleString()}</td>
                </tr>
            `;
            $('#candidate-ranks').append(row);
        });

        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢ (DataTable) ---
        const stationBody = $('#station-rows');
        
        fullStationData.forEach(st => {
            // ‡∏´‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠ Highlight
            const scores = st.slice(6);
            const maxVal = Math.max(...scores);

            let rowHtml = '<tr>';
            rowHtml += `<td class="fw-bold">${st[0]}</td>`; // ‡∏´‡∏ô‡πà‡∏ß‡∏¢
            rowHtml += `<td>${st[1].toLocaleString()}</td>`; // ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥
            rowHtml += `<td>${st[2].toLocaleString()}</td>`; // ‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥
            rowHtml += `<td>${st[3].toLocaleString()}</td>`; // ‡∏î‡∏µ
            rowHtml += `<td class="text-danger">${st[4]}</td>`; // ‡πÄ‡∏™‡∏µ‡∏¢
            rowHtml += `<td class="text-secondary">${st[5]}</td>`; // No
            
            // Loop ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
            scores.forEach(score => {
                const isWin = (score === maxVal && score > 0);
                const cellClass = isWin ? 'winner-cell' : '';
                rowHtml += `<td class="${cellClass}">${score}</td>`;
            });
            rowHtml += '</tr>';
            stationBody.append(rowHtml);
        });

        // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô DataTables
        $('#stationTable').DataTable({
            "language": {
                "search": "üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏ô‡πà‡∏ß‡∏¢/‡πÅ‡∏Ç‡∏ß‡∏á:",
                "lengthMenu": "‡πÅ‡∏™‡∏î‡∏á _MENU_ ‡πÅ‡∏ñ‡∏ß",
                "info": "‡∏´‡∏ô‡πâ‡∏≤ _PAGE_ ‡∏à‡∏≤‡∏Å _PAGES_",
                "paginate": { "next": "‡∏ñ‡∏±‡∏î‡πÑ‡∏õ", "previous": "‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤" }
            },
            "dom": 'Bfrtip',
            "buttons": [
                { extend: 'excelHtml5', title: 'Election_Result_BKK_Zone4', className: 'btn btn-success btn-sm' },
                { extend: 'csvHtml5', title: 'Election_Result_BKK_Zone4', className: 'btn btn-primary btn-sm' }
            ],
            "pageLength": 10,
            "scrollX": true
        });
    });
</script>

</body>

</html>






